<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PawCare - Search Services</title>
  <meta name="organization" content="CLEMS">
  <meta name="author" content="CLEMS">
  <meta name="designer" content="CLEMS">
  <meta name="copyright" content="© 2025 CLEMS. All rights reserved">
  <meta name="robots" content="index,follow">
  <meta name="googlebot" content="index,follow">
  <meta name="revisit-after" content="15days">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50 text-gray-900 leading-relaxed">
  <!-- Header -->
  <header class="flex items-center justify-between px-6 py-4 bg-white border-b border-gray-200 sticky top-0 z-50">
    <div class="flex items-center gap-2 cursor-pointer" onclick="navigateToHome()">
      <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 2C13.1 2 14 2.9 14 4S13.1 6 12 6 10 5.1 10 4 10.9 2 12 2M8.5 7C9.6 7 10.5 7.9 10.5 9S9.6 11 8.5 11 6.5 10.1 6.5 9 7.4 7 8.5 7M15.5 7C16.6 7 17.5 7.9 17.5 9S16.6 11 15.5 11 13.5 10.1 13.5 9 14.4 7 15.5 7M12 8C15.31 8 18 10.69 18 14V22H6V14C6 10.69 8.69 8 12 8Z' fill='%234a5568'/%3E%3C/svg%3E"
        alt="PawCare Logo" class="w-8 h-8">
      <span class="text-xl font-bold text-gray-800">PawCare</span>
    </div>

    <!-- Department filter -->
    <nav class="flex gap-6 items-center">
      <div class="flex items-center gap-2 text-blue-500 font-medium">
        <label for="departmentsSelect" class="text-gray-700">Departament:</label>
        <select id="departmentsSelect" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-400 focus:outline-none">
          <option value="">Choose a Departament</option>
        </select>
      </div>
    </nav>

    <button class="bg-gray-800 text-white px-5 py-2 rounded-md font-medium hover:bg-gray-900 transition" id="searchBtn">
      Search
    </button>
  </header>

  <!-- Main Content -->
  <main class="flex flex-col lg:flex-row gap-6 p-6">
    <!-- Content Area -->
    <div class="flex-1 flex flex-col gap-6" id="servicesContent">
      <div class="text-center py-6 text-gray-500 font-semibold loading">You must select an available option...</div>
      <div id="results"></div>
    </div>
  </main>

  <!-- Back to Start Button -->
  <a href="../pages/profile.html">
    <button class="fixed right-5 bottom-5 bg-gray-900 text-white px-4 py-2 rounded-lg shadow-lg hidden back-to-start">
      Go back
    </button>
  </a>

  <script type="module">
    const select = document.getElementById("departmentsSelect");
    const results = document.getElementById("results");
    const loading = document.querySelector(".loading");
    const searchBtn = document.getElementById("searchBtn");

    // Load departments from API
    async function loadDepartments() {
      try {
        const res = await fetch("http://localhost:3000/departments");
        const data = await res.json();

        data.forEach(dep => {
          const option = document.createElement("option");
          option.value = dep.name;
          option.textContent = dep.name;
          select.appendChild(option);
        });
      } catch (error) {
        console.error("Error loading departments:", error);
      }
    }

    // Search services by department
    searchBtn.addEventListener("click", async () => {
      const department = select.value;
      if (!department) {
        results.innerHTML = "<p class='text-red-600 font-medium'>⚠️ Select a department first</p>";
        return;
      }

      loading.textContent = "Searching services...";

      try {
        // Simulated result (replace with real API request)
        results.innerHTML = `
          <div class="border border-gray-200 p-4 rounded-lg shadow-sm bg-white">
            <h3 class="text-lg font-semibold text-gray-800">Services in ${department}</h3>
            <p class="text-sm text-gray-600">Here will appear the filtered services from API.</p>
          </div>
        `;
        loading.textContent = "";
      } catch (error) {
        console.error("Error searching services:", error);
        results.innerHTML = "<p class='text-red-600 font-medium'>❌ Error loading services.</p>";
      }
    });

    // Init
    loadDepartments();
  </script>
</body>
</html>
